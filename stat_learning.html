<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical Learning</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="demographics.html">Demographics</a>
    </li>
    <li>
      <a href="trends.html">Trends</a>
    </li>
    <li>
      <a href="stat_learning.html">Statistical Learning</a>
    </li>
  </ul>
</li>
<li>
  <a href="index_report.html">Report</a>
</li>
<li>
  <a href="index_screencast.html">Screencast</a>
</li>
<li>
  <a href="https://github.com/Akbarnejadhn/p8105_fnl_project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Learning</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#spaghetti-plots">Spaghetti Plots</a></li>
<li><a href="#clustering-with-opioid-deaths">Clustering with Opioid Deaths</a></li>
<li><a href="#clustering-with-er-visits">Clustering with ER Visits</a></li>
<li><a href="#scatter-plots">Scatter Plots</a></li>
<li><a href="#model-building">Model Building</a></li>
</ul>
</div>

<pre class="r"><code>opioid_death_data = read_csv(&#39;./opioid_related_deaths.csv&#39;) %&gt;% 
  janitor::clean_names()

opioid_er_data = read_csv(&#39;./opioid_related_visits.csv&#39;) %&gt;% 
  janitor::clean_names()
                                        
opioid_treatment_distance = read_csv(&#39;./distance_to_treatment.csv&#39;) %&gt;% 
  janitor::clean_names()

opioid_dem_df = read_csv(&#39;./data/deaths_age_group.csv&#39;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre class="r"><code>prod_county = arcos::summarized_county_annual(state = &quot;NY&quot;, key = &quot;WaPo&quot;) %&gt;% 
  janitor::clean_names()

county_pop = arcos::county_population(state = &quot;NY&quot;, key = &quot;WaPo&quot;) %&gt;% 
  janitor::clean_names()</code></pre>
<pre class="r"><code># clean opioid death data #

opioid_death_data = opioid_death_data %&gt;%
  filter(year &gt;= 2010) %&gt;% 
  mutate(county = recode(county, &quot;Kings (Brooklyn)&quot; = &quot;Kings&quot;,
                         &quot;New York (Manhattan)&quot; = &quot;New York&quot;,
                         &quot;St Lawrence&quot; = &quot;St. Lawrence&quot;))

# clean opioid er data #

opioid_er_data = opioid_er_data %&gt;% 
  select(year, patient_county_name, rural_urban, payer, er_opioid, inpatient_total_opioid, er_inpatient_total_opioid, outpatient_opioid, overall_opioid) %&gt;%
  rename(county = patient_county_name)

# Combine Data Sets #

opioid_total_data = left_join(opioid_er_data, opioid_death_data, by = c(&#39;county&#39;, &#39;year&#39;)) %&gt;% 
  arrange(county, year)</code></pre>
<pre class="r"><code># Pills bought by Pharmacies in Each county per Year #

pharma_df = left_join(prod_county, county_pop, by = c(&quot;buyer_county&quot;, &quot;year&quot;)) %&gt;% 
  select(county_name, year, count, population) %&gt;% 
  rename(county = county_name,
         pills_bought = count) %&gt;% 
  mutate(ppp = pills_bought/population)</code></pre>
<div id="spaghetti-plots" class="section level2">
<h2>Spaghetti Plots</h2>
<p>This exploratory analysis clusters opioid related data adjusted for population in each county</p>
<p>by the intercepts and slopes. This involved joining our population data with opioid related</p>
<p>interventions in hospitals. The intercepts and slopes were extracted from linear models.</p>
<pre class="r"><code>sum_df &lt;- opioid_total_data %&gt;% 
  group_by(county, year, rural_urban) %&gt;% 
  summarize(er_opioid = sum(er_opioid),
            inpatient_total_opioid = sum(inpatient_total_opioid),
            er_inpatient_total_opioid = sum(er_inpatient_total_opioid),
            outpatient_opioid = sum(outpatient_opioid),
            overall_opioid = sum(overall_opioid),
            opioid_poisoning_deaths = sum(opioid_poisoning_deaths)
  )</code></pre>
<pre class="r"><code>join_df &lt;- inner_join(sum_df, pharma_df, by = c(&quot;county&quot;, &quot;year&quot;))</code></pre>
<pre class="r"><code>sum_total_df &lt;- opioid_total_data %&gt;% 
  group_by(county, year) %&gt;% 
  summarize(er_opioid = sum(er_opioid),
            inpatient_total_opioid = sum(inpatient_total_opioid),
            er_inpatient_total_opioid = sum(er_inpatient_total_opioid),
            outpatient_opioid = sum(outpatient_opioid),
            overall_opioid = sum(overall_opioid),
            opioid_poisoning_deaths = sum(opioid_poisoning_deaths)
  )</code></pre>
<pre class="r"><code>death_sales_df &lt;- inner_join(sum_total_df, pharma_df, by = c(&quot;county&quot;, &quot;year&quot;))</code></pre>
<pre class="r"><code>int_slope_dat &lt;- pharma_df %&gt;% 
  mutate(
    year = recode(year, 
                  &quot;2006&quot; = 0,
                  &quot;2007&quot; = 1,
                  &quot;2008&quot; = 2,
                  &quot;2009&quot; = 3,
                  &quot;2010&quot; = 4,
                  &quot;2011&quot; = 5,
                  &quot;2012&quot; = 6)
  ) %&gt;% 
  group_by(county, year) %&gt;% 
  summarize(ppp = pills_bought/population)</code></pre>
<pre class="r"><code>int_slope_df &lt;- int_slope_dat %&gt;% 
  nest(data = year:ppp) %&gt;%
  mutate(
    models = map(data, ~lm(ppp ~ year, data = .x)),
    result = map(models, broom::tidy)
  ) %&gt;% 
  select(county, result) %&gt;% 
  unnest(result) %&gt;% 
  select(county, term, estimate) %&gt;% 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) %&gt;% 
  rename(int = &quot;(Intercept)&quot;, slope = year)</code></pre>
<pre class="r"><code>km_fit = 
  kmeans(
    int_slope_df[,c(2,3)]  %&gt;% scale, 
    centers = 3)

int_slope_df =
  broom::augment(km_fit, int_slope_df)</code></pre>
<pre class="r"><code>pills_plot &lt;- left_join(int_slope_dat, int_slope_df) %&gt;% 
  group_by(county) %&gt;% 
  ggplot(aes(x = year, y = ppp, color = .cluster, text = county)) + 
  geom_point() + 
  geom_path() +
  scale_x_continuous(breaks = c(0, 1, 2, 3, 4, 5, 6), labels = c(&quot;2006&quot;, &quot;2007&quot;, &quot;2008&quot;, &quot;2009&quot;, &quot;2010&quot;, &quot;2011&quot;, &quot;2012&quot;)) +
  theme(legend.position = &quot;none&quot;) +
  xlab(&quot;Year&quot;) +
  ylab(&quot;Pills Bought Per Person&quot;)</code></pre>
<pre class="r"><code>ggplotly(pills_plot, tooltip = &quot;text&quot;)</code></pre>
<div id="htmlwidget-9a72f1b44539a5ab0521" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9a72f1b44539a5ab0521">{"x":{"data":[{"x":[0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6],"y":[0.0759132073178144,0.08121599869598,0.0799154076092482,0.0766738879552955,0.0858975664392628,0.0879957543222225,0.090648483731597,0.0833528284512581,0.0918870751753561,0.0985579195041511,0.098627624750908,0.10113842353738,0.109335089399745,0.112715577607939,0.0834009490791965,0.0875567508882748,0.0990700957145157,0.102316145813887,0.110280281271665,0.111719973160367,0.1117057106504,0.0755385184176218,0.0881798573732585,0.0986634454272688,0.0974958787973938,0.0989910862964051,0.0908876112467512,0.0774608833432363,0.0868167202572347,0.0955787522166694,0.107616529059087,0.109029808948908,0.112776025236593,0.111789810076657,0.098254908701191,0.0761326676472416,0.0929618163054696,0.0966441287761305,0.0910724336493917,0.0950228121111572,0.0943447243079099,0.085891621909678,0.0907781633684975,0.0990327447941017,0.108692322482459,0.10950448479545,0.115797620934388,0.119954681564051,0.119215870509449,0.0989229601939412,0.107608751060053,0.115499575982539,0.113236383630069,0.11776603228673,0.115388176044733,0.116014805275422,0.084974778977057,0.0946308913973297,0.105801429212552,0.107492409319461,0.112548091023584,0.115477683305336,0.112720650222339,0.0789916287603685,0.0836659823600973,0.0912212376060657,0.0967324024758889,0.101347156108299,0.102689829083777,0.0919259616812713,0.0720562102761455,0.0826159407703331,0.0863422843266226,0.089738891190499,0.095318489145086,0.0946365707185753,0.0914865491713389,0.0787885766927683,0.0891975451063633,0.0926157118416794,0.0926852288815479,0.0979869813986889,0.102624909906768,0.102965461100128,0.0984737910902399,0.108608576787361,0.119962916193795,0.112891795251748,0.128889527825698,0.132237896761783,0.130126957053438,0.0839533388444934,0.0894084027482216,0.0899057464274856,0.0876371294753717,0.0968007563512154,0.0947628639443325,0.0869485237759451,0.112681313993174,0.124231571069653,0.127976829006651,0.122565622353937,0.136055154583648,0.131206057328286,0.0873213512343006,0.088095213916505,0.093311413523305,0.0966918542227985,0.0987132010675052,0.100421376767554,0.10444469176523,0.10477614352675,0.074391478599591,0.0816069086361341,0.0856292789305359,0.0830990557421835,0.0893819289493494,0.0904303926163463,0.0810916936932108,0.105152076238816,0.112936108012463,0.117432962510449,0.119738159211843,0.129481481481481,0.132967132154784,0.116369278510473,0.0690309179034832,0.0755179661695526,0.0848251197911997,0.0892198482845014,0.0949886693436171,0.0957508932724951,0.0900167372255587,0.0768629166780607,0.0834162938003916,0.0885278478386671,0.0912291333810809,0.0974220656300949,0.107071315198949,0.100676105108593],"text":["Allegany","Allegany","Allegany","Allegany","Allegany","Allegany","Allegany","Broome","Broome","Broome","Broome","Broome","Broome","Broome","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Chenango","Chenango","Chenango","Chenango","Chenango","Chenango","Chenango","Cortland","Cortland","Cortland","Cortland","Cortland","Cortland","Cortland","Delaware","Delaware","Delaware","Delaware","Delaware","Delaware","Delaware","Erie","Erie","Erie","Erie","Erie","Erie","Erie","Niagara","Niagara","Niagara","Niagara","Niagara","Niagara","Niagara","Onondaga","Onondaga","Onondaga","Onondaga","Onondaga","Onondaga","Onondaga","Ontario","Ontario","Ontario","Ontario","Ontario","Ontario","Ontario","Orange","Orange","Orange","Orange","Orange","Orange","Orange","Orleans","Orleans","Orleans","Orleans","Orleans","Orleans","Orleans","Otsego","Otsego","Otsego","Otsego","Otsego","Otsego","Otsego","Schoharie","Schoharie","Schoharie","Schoharie","Schoharie","Schoharie","Schoharie","Schuyler","Schuyler","Schuyler","Schuyler","Schuyler","Schuyler","Schuyler","Steuben","Steuben","Steuben","Steuben","Steuben","Steuben","Steuben","Suffolk","Suffolk","Suffolk","Suffolk","Suffolk","Suffolk","Suffolk","Sullivan","Sullivan","Sullivan","Sullivan","Sullivan","Sullivan","Sullivan","Tompkins","Tompkins","Tompkins","Tompkins","Tompkins","Tompkins","Tompkins","Ulster","Ulster","Ulster","Ulster","Ulster","Ulster","Ulster"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6],"y":[0.0516320884745573,0.0606335854247708,0.0667151732243801,0.0691859315347203,0.0708576728765393,0.0694275835068776,0.0692717176062605,0.0257906308134619,0.0297956657627159,0.0331510068295431,0.0355548092005307,0.0402394332680444,0.0426409853680326,0.0427066773228387,0.0640421271698173,0.070345262494088,0.0788104912019983,0.084591028175579,0.0896728388229155,0.0835778288795496,0.0822665033953022,0.066512391758734,0.0767610617671061,0.0793574714699916,0.0813622782670002,0.086026770037008,0.0887104924505292,0.0875842188293625,0.0611625216888375,0.0726810719241651,0.0723229706390328,0.0745943195653359,0.0829954772330036,0.0885747259088286,0.0818129267675855,0.000802085422097453,0.000804990943851882,0.00122624156958921,0.000598682897625224,0.000611246943765281,0.000410677618069815,0.000827300930713547,0.0276791241197111,0.0309242034240437,0.0332012253486379,0.0341545383627381,0.0381869982835938,0.0400656605737698,0.0378678255609414,0.0392207696011259,0.0464446577567747,0.0604211622888608,0.0682312535775615,0.067735129733131,0.0678699559862411,0.070652575567216,0.0527104977278639,0.062985029025359,0.0712403065344242,0.0765808555777208,0.0806222398801974,0.0827381589612614,0.0753660967568811,0.0670595357896006,0.0730795712946517,0.0794420648351322,0.0822557034311481,0.0891141467257721,0.0899966746681063,0.089704409288536,0.0606881248089486,0.0663410103112746,0.0694981394264257,0.0682233238636154,0.0730631570789785,0.0727343247706023,0.0644335749586169,0.0430656753925905,0.0477645785195668,0.0510106350132512,0.0536687473241199,0.0597361914175369,0.0625786632767871,0.0618167698459669,0.0619986513280393,0.0702334747722565,0.0710790962154777,0.0659462622715945,0.0676879803104124,0.0671770584575866,0.0664078955286755,0.0276356088840966,0.0313743627003639,0.0330772425343826,0.0340012111318817,0.039049750155627,0.0414268079569029,0.0397430344768341,0.0549036310008137,0.0672130836751073,0.0775669607762985,0.0793199305998981,0.083030215156119,0.0847516236726123,0.079579089951337,0.0627828758875555,0.0722257757124023,0.0746989978455945,0.0710601695476522,0.0738137878951343,0.0738744383457001,0.0685605947383928,0.047102441631317,0.0520605433788138,0.0558686107009197,0.0588130428055352,0.0572315287385296,0.0558957114441399,0.0542256523007202,0.0463501796139349,0.0545000417056692,0.0628492005780506,0.0634067928920833,0.0684881066352456,0.07166392092257,0.0696077004257797,0.0515128353803173,0.0619668363158759,0.0673839332290037,0.0652737349974082,0.072291672103766,0.0731412609218176,0.0746766278663266,0.0709763506799534,0.0677211085736841,0.0701441899915182,0.0675228928352008,0.0775439689597553,0.086132668668215,0.0782869767178383,0.0470544861844148,0.0545718995442645,0.0506621616373451,0.0503107193201898,0.0487961539210152,0.049583715171486,0.049856071435565,0.0504373038505042,0.06172487074571,0.0690254853601467,0.0704637838875908,0.075148998224702,0.0792889479849305,0.0781042023198327,0.0648218387734388,0.0723441559135762,0.0838925100545131,0.0821423116367366,0.0919127853588741,0.094587089332251,0.0871346655826094,0.0458973659743232,0.0517465990439398,0.0544157602173558,0.0549992097360518,0.0578865793916581,0.0590172719272141,0.0563012837985029,0.0582569774799053,0.058967423262378,0.0692982663607767,0.0763032042085127,0.0749167984516251,0.0778485659474694,0.0774731540435237,0.0648151848151848,0.0697867955932472,0.0709608709372042,0.0798744189839354,0.0813069306930693,0.0858259016652198,0.0846120468620567],"text":["Albany","Albany","Albany","Albany","Albany","Albany","Albany","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Columbia","Columbia","Columbia","Columbia","Columbia","Columbia","Columbia","Dutchess","Dutchess","Dutchess","Dutchess","Dutchess","Dutchess","Dutchess","Fulton","Fulton","Fulton","Fulton","Fulton","Fulton","Fulton","Hamilton","Hamilton","Hamilton","Hamilton","Hamilton","Hamilton","Hamilton","Kings","Kings","Kings","Kings","Kings","Kings","Kings","Lewis","Lewis","Lewis","Lewis","Lewis","Lewis","Lewis","Livingston","Livingston","Livingston","Livingston","Livingston","Livingston","Livingston","Monroe","Monroe","Monroe","Monroe","Monroe","Monroe","Monroe","Nassau","Nassau","Nassau","Nassau","Nassau","Nassau","Nassau","New York","New York","New York","New York","New York","New York","New York","Putnam","Putnam","Putnam","Putnam","Putnam","Putnam","Putnam","Queens","Queens","Queens","Queens","Queens","Queens","Queens","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Richmond","Richmond","Richmond","Richmond","Richmond","Richmond","Richmond","Rockland","Rockland","Rockland","Rockland","Rockland","Rockland","Rockland","Saratoga","Saratoga","Saratoga","Saratoga","Saratoga","Saratoga","Saratoga","Schenectady","Schenectady","Schenectady","Schenectady","Schenectady","Schenectady","Schenectady","Seneca","Seneca","Seneca","Seneca","Seneca","Seneca","Seneca","Tioga","Tioga","Tioga","Tioga","Tioga","Tioga","Tioga","Washington","Washington","Washington","Washington","Washington","Washington","Washington","Wayne","Wayne","Wayne","Wayne","Wayne","Wayne","Wayne","Westchester","Westchester","Westchester","Westchester","Westchester","Westchester","Westchester","Wyoming","Wyoming","Wyoming","Wyoming","Wyoming","Wyoming","Wyoming","Yates","Yates","Yates","Yates","Yates","Yates","Yates"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6,0,1,2,3,4,5,6],"y":[0.0594372743905454,0.0676803631447742,0.0799806167838771,0.0870690301772633,0.0963434496649302,0.104296543813276,0.103167658382919,0.0817605426127986,0.0876801913183398,0.0962811231318726,0.103111621593401,0.109150321965356,0.111644373342814,0.112289095758512,0.0708199972952261,0.0854186880880926,0.0989344993955007,0.118000022685768,0.12224376606394,0.126517226223079,0.133398664098492,0.0784765042945231,0.0877464993458985,0.100787611800828,0.113803437098648,0.132386501578053,0.146708806904516,0.149511297438272,0.0544948088123576,0.0562822238589897,0.0634715354380626,0.0720594826904316,0.0777095595697179,0.0865665574103717,0.085552926810654,0.066840092407447,0.0774400370785215,0.0815689598705377,0.0923095247548338,0.101998181712672,0.107346599369573,0.107180161708383,0.0837630801582136,0.0914066410812615,0.106519742883379,0.10831844420011,0.113841072858287,0.123253176800187,0.119215895452727,0.0731525054026215,0.0880150190766498,0.0987122728283502,0.112979152656355,0.120643594414086,0.122783885756014,0.114490452343146,0.0693435786909057,0.0819825000388543,0.0988292652630271,0.100594179919602,0.101597960579494,0.105214905056407,0.101233036060489,0.0498988121425429,0.0572228161204252,0.0732746255422357,0.0812024320761937,0.0897113905569702,0.0977307423603384,0.0960337062327473,0.0695288859276533,0.0779408326341993,0.0858433116660965,0.0902845365546459,0.0925816675127252,0.100388211493247,0.0994559929840909,0.0789357252031212,0.0938792722599301,0.0973353886809073,0.102134397104787,0.117669436380018,0.123737121136341,0.128295852073963,0.07247608110012,0.0835607792296408,0.0957685451335284,0.100840154266348,0.108824770927759,0.115617632136568,0.112227741362829,0.0732137894960524,0.0884275813538658,0.104146576663452,0.107453038128763,0.120749468172149,0.120918776492153,0.110704190733686,0.058992792857399,0.0670514222214256,0.0818828122201927,0.0914417451841592,0.093005779312566,0.102210018871468,0.0952971622345172,0.0879122555450468,0.10442652874962,0.106077633337383,0.109821577962673,0.127490221741976,0.133167089877902,0.126133942161339],"text":["Cayuga","Cayuga","Cayuga","Cayuga","Cayuga","Cayuga","Cayuga","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chemung","Chemung","Chemung","Chemung","Chemung","Chemung","Chemung","Clinton","Clinton","Clinton","Clinton","Clinton","Clinton","Clinton","Essex","Essex","Essex","Essex","Essex","Essex","Essex","Franklin","Franklin","Franklin","Franklin","Franklin","Franklin","Franklin","Genesee","Genesee","Genesee","Genesee","Genesee","Genesee","Genesee","Greene","Greene","Greene","Greene","Greene","Greene","Greene","Herkimer","Herkimer","Herkimer","Herkimer","Herkimer","Herkimer","Herkimer","Jefferson","Jefferson","Jefferson","Jefferson","Jefferson","Jefferson","Jefferson","Madison","Madison","Madison","Madison","Madison","Madison","Madison","Montgomery","Montgomery","Montgomery","Montgomery","Montgomery","Montgomery","Montgomery","Oneida","Oneida","Oneida","Oneida","Oneida","Oneida","Oneida","Oswego","Oswego","Oswego","Oswego","Oswego","Oswego","Oswego","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Warren","Warren","Warren","Warren","Warren","Warren","Warren"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6],"y":[0.0759132073178144,0.08121599869598,0.0799154076092482,0.0766738879552955,0.0858975664392628,0.0879957543222225,0.090648483731597,null,0.0833528284512581,0.0918870751753561,0.0985579195041511,0.098627624750908,0.10113842353738,0.109335089399745,0.112715577607939,null,0.0834009490791965,0.0875567508882748,0.0990700957145157,0.102316145813887,0.110280281271665,0.111719973160367,0.1117057106504,null,0.0755385184176218,0.0881798573732585,0.0986634454272688,0.0974958787973938,0.0989910862964051,0.0908876112467512,0.0774608833432363,null,0.0868167202572347,0.0955787522166694,0.107616529059087,0.109029808948908,0.112776025236593,0.111789810076657,0.098254908701191,null,0.0761326676472416,0.0929618163054696,0.0966441287761305,0.0910724336493917,0.0950228121111572,0.0943447243079099,0.085891621909678,null,0.0907781633684975,0.0990327447941017,0.108692322482459,0.10950448479545,0.115797620934388,0.119954681564051,0.119215870509449,null,0.0989229601939412,0.107608751060053,0.115499575982539,0.113236383630069,0.11776603228673,0.115388176044733,0.116014805275422,null,0.084974778977057,0.0946308913973297,0.105801429212552,0.107492409319461,0.112548091023584,0.115477683305336,0.112720650222339,null,0.0789916287603685,0.0836659823600973,0.0912212376060657,0.0967324024758889,0.101347156108299,0.102689829083777,0.0919259616812713,null,0.0720562102761455,0.0826159407703331,0.0863422843266226,0.089738891190499,0.095318489145086,0.0946365707185753,0.0914865491713389,null,0.0787885766927683,0.0891975451063633,0.0926157118416794,0.0926852288815479,0.0979869813986889,0.102624909906768,0.102965461100128,null,0.0984737910902399,0.108608576787361,0.119962916193795,0.112891795251748,0.128889527825698,0.132237896761783,0.130126957053438,null,0.0839533388444934,0.0894084027482216,0.0899057464274856,0.0876371294753717,0.0968007563512154,0.0947628639443325,0.0869485237759451,null,0.112681313993174,0.124231571069653,0.127976829006651,0.122565622353937,0.136055154583648,0.131206057328286,0.0873213512343006,null,0.088095213916505,0.093311413523305,0.0966918542227985,0.0987132010675052,0.100421376767554,0.10444469176523,0.10477614352675,null,0.074391478599591,0.0816069086361341,0.0856292789305359,0.0830990557421835,0.0893819289493494,0.0904303926163463,0.0810916936932108,null,0.105152076238816,0.112936108012463,0.117432962510449,0.119738159211843,0.129481481481481,0.132967132154784,0.116369278510473,null,0.0690309179034832,0.0755179661695526,0.0848251197911997,0.0892198482845014,0.0949886693436171,0.0957508932724951,0.0900167372255587,null,0.0768629166780607,0.0834162938003916,0.0885278478386671,0.0912291333810809,0.0974220656300949,0.107071315198949,0.100676105108593],"text":["Allegany","Allegany","Allegany","Allegany","Allegany","Allegany","Allegany",null,"Broome","Broome","Broome","Broome","Broome","Broome","Broome",null,"Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus","Cattaraugus",null,"Chenango","Chenango","Chenango","Chenango","Chenango","Chenango","Chenango",null,"Cortland","Cortland","Cortland","Cortland","Cortland","Cortland","Cortland",null,"Delaware","Delaware","Delaware","Delaware","Delaware","Delaware","Delaware",null,"Erie","Erie","Erie","Erie","Erie","Erie","Erie",null,"Niagara","Niagara","Niagara","Niagara","Niagara","Niagara","Niagara",null,"Onondaga","Onondaga","Onondaga","Onondaga","Onondaga","Onondaga","Onondaga",null,"Ontario","Ontario","Ontario","Ontario","Ontario","Ontario","Ontario",null,"Orange","Orange","Orange","Orange","Orange","Orange","Orange",null,"Orleans","Orleans","Orleans","Orleans","Orleans","Orleans","Orleans",null,"Otsego","Otsego","Otsego","Otsego","Otsego","Otsego","Otsego",null,"Schoharie","Schoharie","Schoharie","Schoharie","Schoharie","Schoharie","Schoharie",null,"Schuyler","Schuyler","Schuyler","Schuyler","Schuyler","Schuyler","Schuyler",null,"Steuben","Steuben","Steuben","Steuben","Steuben","Steuben","Steuben",null,"Suffolk","Suffolk","Suffolk","Suffolk","Suffolk","Suffolk","Suffolk",null,"Sullivan","Sullivan","Sullivan","Sullivan","Sullivan","Sullivan","Sullivan",null,"Tompkins","Tompkins","Tompkins","Tompkins","Tompkins","Tompkins","Tompkins",null,"Ulster","Ulster","Ulster","Ulster","Ulster","Ulster","Ulster"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6],"y":[0.0516320884745573,0.0606335854247708,0.0667151732243801,0.0691859315347203,0.0708576728765393,0.0694275835068776,0.0692717176062605,null,0.0257906308134619,0.0297956657627159,0.0331510068295431,0.0355548092005307,0.0402394332680444,0.0426409853680326,0.0427066773228387,null,0.0640421271698173,0.070345262494088,0.0788104912019983,0.084591028175579,0.0896728388229155,0.0835778288795496,0.0822665033953022,null,0.066512391758734,0.0767610617671061,0.0793574714699916,0.0813622782670002,0.086026770037008,0.0887104924505292,0.0875842188293625,null,0.0611625216888375,0.0726810719241651,0.0723229706390328,0.0745943195653359,0.0829954772330036,0.0885747259088286,0.0818129267675855,null,0.000802085422097453,0.000804990943851882,0.00122624156958921,0.000598682897625224,0.000611246943765281,0.000410677618069815,0.000827300930713547,null,0.0276791241197111,0.0309242034240437,0.0332012253486379,0.0341545383627381,0.0381869982835938,0.0400656605737698,0.0378678255609414,null,0.0392207696011259,0.0464446577567747,0.0604211622888608,0.0682312535775615,0.067735129733131,0.0678699559862411,0.070652575567216,null,0.0527104977278639,0.062985029025359,0.0712403065344242,0.0765808555777208,0.0806222398801974,0.0827381589612614,0.0753660967568811,null,0.0670595357896006,0.0730795712946517,0.0794420648351322,0.0822557034311481,0.0891141467257721,0.0899966746681063,0.089704409288536,null,0.0606881248089486,0.0663410103112746,0.0694981394264257,0.0682233238636154,0.0730631570789785,0.0727343247706023,0.0644335749586169,null,0.0430656753925905,0.0477645785195668,0.0510106350132512,0.0536687473241199,0.0597361914175369,0.0625786632767871,0.0618167698459669,null,0.0619986513280393,0.0702334747722565,0.0710790962154777,0.0659462622715945,0.0676879803104124,0.0671770584575866,0.0664078955286755,null,0.0276356088840966,0.0313743627003639,0.0330772425343826,0.0340012111318817,0.039049750155627,0.0414268079569029,0.0397430344768341,null,0.0549036310008137,0.0672130836751073,0.0775669607762985,0.0793199305998981,0.083030215156119,0.0847516236726123,0.079579089951337,null,0.0627828758875555,0.0722257757124023,0.0746989978455945,0.0710601695476522,0.0738137878951343,0.0738744383457001,0.0685605947383928,null,0.047102441631317,0.0520605433788138,0.0558686107009197,0.0588130428055352,0.0572315287385296,0.0558957114441399,0.0542256523007202,null,0.0463501796139349,0.0545000417056692,0.0628492005780506,0.0634067928920833,0.0684881066352456,0.07166392092257,0.0696077004257797,null,0.0515128353803173,0.0619668363158759,0.0673839332290037,0.0652737349974082,0.072291672103766,0.0731412609218176,0.0746766278663266,null,0.0709763506799534,0.0677211085736841,0.0701441899915182,0.0675228928352008,0.0775439689597553,0.086132668668215,0.0782869767178383,null,0.0470544861844148,0.0545718995442645,0.0506621616373451,0.0503107193201898,0.0487961539210152,0.049583715171486,0.049856071435565,null,0.0504373038505042,0.06172487074571,0.0690254853601467,0.0704637838875908,0.075148998224702,0.0792889479849305,0.0781042023198327,null,0.0648218387734388,0.0723441559135762,0.0838925100545131,0.0821423116367366,0.0919127853588741,0.094587089332251,0.0871346655826094,null,0.0458973659743232,0.0517465990439398,0.0544157602173558,0.0549992097360518,0.0578865793916581,0.0590172719272141,0.0563012837985029,null,0.0582569774799053,0.058967423262378,0.0692982663607767,0.0763032042085127,0.0749167984516251,0.0778485659474694,0.0774731540435237,null,0.0648151848151848,0.0697867955932472,0.0709608709372042,0.0798744189839354,0.0813069306930693,0.0858259016652198,0.0846120468620567],"text":["Albany","Albany","Albany","Albany","Albany","Albany","Albany",null,"Bronx","Bronx","Bronx","Bronx","Bronx","Bronx","Bronx",null,"Columbia","Columbia","Columbia","Columbia","Columbia","Columbia","Columbia",null,"Dutchess","Dutchess","Dutchess","Dutchess","Dutchess","Dutchess","Dutchess",null,"Fulton","Fulton","Fulton","Fulton","Fulton","Fulton","Fulton",null,"Hamilton","Hamilton","Hamilton","Hamilton","Hamilton","Hamilton","Hamilton",null,"Kings","Kings","Kings","Kings","Kings","Kings","Kings",null,"Lewis","Lewis","Lewis","Lewis","Lewis","Lewis","Lewis",null,"Livingston","Livingston","Livingston","Livingston","Livingston","Livingston","Livingston",null,"Monroe","Monroe","Monroe","Monroe","Monroe","Monroe","Monroe",null,"Nassau","Nassau","Nassau","Nassau","Nassau","Nassau","Nassau",null,"New York","New York","New York","New York","New York","New York","New York",null,"Putnam","Putnam","Putnam","Putnam","Putnam","Putnam","Putnam",null,"Queens","Queens","Queens","Queens","Queens","Queens","Queens",null,"Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer","Rensselaer",null,"Richmond","Richmond","Richmond","Richmond","Richmond","Richmond","Richmond",null,"Rockland","Rockland","Rockland","Rockland","Rockland","Rockland","Rockland",null,"Saratoga","Saratoga","Saratoga","Saratoga","Saratoga","Saratoga","Saratoga",null,"Schenectady","Schenectady","Schenectady","Schenectady","Schenectady","Schenectady","Schenectady",null,"Seneca","Seneca","Seneca","Seneca","Seneca","Seneca","Seneca",null,"Tioga","Tioga","Tioga","Tioga","Tioga","Tioga","Tioga",null,"Washington","Washington","Washington","Washington","Washington","Washington","Washington",null,"Wayne","Wayne","Wayne","Wayne","Wayne","Wayne","Wayne",null,"Westchester","Westchester","Westchester","Westchester","Westchester","Westchester","Westchester",null,"Wyoming","Wyoming","Wyoming","Wyoming","Wyoming","Wyoming","Wyoming",null,"Yates","Yates","Yates","Yates","Yates","Yates","Yates"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6,null,0,1,2,3,4,5,6],"y":[0.0594372743905454,0.0676803631447742,0.0799806167838771,0.0870690301772633,0.0963434496649302,0.104296543813276,0.103167658382919,null,0.0817605426127986,0.0876801913183398,0.0962811231318726,0.103111621593401,0.109150321965356,0.111644373342814,0.112289095758512,null,0.0708199972952261,0.0854186880880926,0.0989344993955007,0.118000022685768,0.12224376606394,0.126517226223079,0.133398664098492,null,0.0784765042945231,0.0877464993458985,0.100787611800828,0.113803437098648,0.132386501578053,0.146708806904516,0.149511297438272,null,0.0544948088123576,0.0562822238589897,0.0634715354380626,0.0720594826904316,0.0777095595697179,0.0865665574103717,0.085552926810654,null,0.066840092407447,0.0774400370785215,0.0815689598705377,0.0923095247548338,0.101998181712672,0.107346599369573,0.107180161708383,null,0.0837630801582136,0.0914066410812615,0.106519742883379,0.10831844420011,0.113841072858287,0.123253176800187,0.119215895452727,null,0.0731525054026215,0.0880150190766498,0.0987122728283502,0.112979152656355,0.120643594414086,0.122783885756014,0.114490452343146,null,0.0693435786909057,0.0819825000388543,0.0988292652630271,0.100594179919602,0.101597960579494,0.105214905056407,0.101233036060489,null,0.0498988121425429,0.0572228161204252,0.0732746255422357,0.0812024320761937,0.0897113905569702,0.0977307423603384,0.0960337062327473,null,0.0695288859276533,0.0779408326341993,0.0858433116660965,0.0902845365546459,0.0925816675127252,0.100388211493247,0.0994559929840909,null,0.0789357252031212,0.0938792722599301,0.0973353886809073,0.102134397104787,0.117669436380018,0.123737121136341,0.128295852073963,null,0.07247608110012,0.0835607792296408,0.0957685451335284,0.100840154266348,0.108824770927759,0.115617632136568,0.112227741362829,null,0.0732137894960524,0.0884275813538658,0.104146576663452,0.107453038128763,0.120749468172149,0.120918776492153,0.110704190733686,null,0.058992792857399,0.0670514222214256,0.0818828122201927,0.0914417451841592,0.093005779312566,0.102210018871468,0.0952971622345172,null,0.0879122555450468,0.10442652874962,0.106077633337383,0.109821577962673,0.127490221741976,0.133167089877902,0.126133942161339],"text":["Cayuga","Cayuga","Cayuga","Cayuga","Cayuga","Cayuga","Cayuga",null,"Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua","Chautauqua",null,"Chemung","Chemung","Chemung","Chemung","Chemung","Chemung","Chemung",null,"Clinton","Clinton","Clinton","Clinton","Clinton","Clinton","Clinton",null,"Essex","Essex","Essex","Essex","Essex","Essex","Essex",null,"Franklin","Franklin","Franklin","Franklin","Franklin","Franklin","Franklin",null,"Genesee","Genesee","Genesee","Genesee","Genesee","Genesee","Genesee",null,"Greene","Greene","Greene","Greene","Greene","Greene","Greene",null,"Herkimer","Herkimer","Herkimer","Herkimer","Herkimer","Herkimer","Herkimer",null,"Jefferson","Jefferson","Jefferson","Jefferson","Jefferson","Jefferson","Jefferson",null,"Madison","Madison","Madison","Madison","Madison","Madison","Madison",null,"Montgomery","Montgomery","Montgomery","Montgomery","Montgomery","Montgomery","Montgomery",null,"Oneida","Oneida","Oneida","Oneida","Oneida","Oneida","Oneida",null,"Oswego","Oswego","Oswego","Oswego","Oswego","Oswego","Oswego",null,"Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence","Saint Lawrence",null,"Warren","Warren","Warren","Warren","Warren","Warren","Warren"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.7412480974125,"r":7.30593607305936,"b":39.6955859969559,"l":48.9497716894977},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.3,6.3],"tickmode":"array","ticktext":["2006","2007","2008","2009","2010","2011","2012"],"tickvals":[0,1,2,3,4,5,6],"categoryorder":"array","categoryarray":["2006","2007","2008","2009","2010","2011","2012"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.00704435337294031,0.156966328429282],"tickmode":"array","ticktext":["0.00","0.05","0.10","0.15"],"tickvals":[0,0.05,0.1,0.15],"categoryorder":"array","categoryarray":["0.00","0.05","0.10","0.15"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Pills Bought Per Person","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"44704d7e25d4":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"447044570ee":{"x":{},"y":{},"colour":{},"text":{}}},"cur_data":"44704d7e25d4","visdat":{"44704d7e25d4":["function (y) ","x"],"447044570ee":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>death_sales_dat &lt;- death_sales_df %&gt;%
  ungroup() %&gt;% 
  mutate(
    year = recode(year, 
                  &quot;2010&quot; = 0,
                  &quot;2011&quot; = 1,
                  &quot;2012&quot; = 2)
  )</code></pre>
</div>
<div id="clustering-with-opioid-deaths" class="section level2">
<h2>Clustering with Opioid Deaths</h2>
<pre class="r"><code>death_sales_dat &lt;- death_sales_df %&gt;% 
  select(county, year, opioid_poisoning_deaths, population) %&gt;% 
  mutate(
    year = recode(year,
                  &quot;2010&quot; = 0,
                  &quot;2011&quot; = 1,
                  &quot;2012&quot; = 2)
  )</code></pre>
<pre class="r"><code>death_int_slope_df &lt;- death_sales_dat %&gt;% 
  nest(data = year:population) %&gt;%
  mutate(
    models = map(data, ~lm(opioid_poisoning_deaths/population*10000 ~ year, data = .x)),
    result = map(models, broom::tidy)
  ) %&gt;% 
  select(county, result) %&gt;% 
  unnest(result) %&gt;% 
  select(county, term, estimate) %&gt;% 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) %&gt;% 
  rename(int = &quot;(Intercept)&quot;, slope = year)</code></pre>
<pre class="r"><code>death_km_fit = 
  kmeans(
    death_int_slope_df[,c(2,3)] %&gt;% scale, 
    centers = 3)

death_int_slope_df =
  broom::augment(death_km_fit, death_int_slope_df)</code></pre>
<pre class="r"><code>deaths_plot &lt;- left_join(death_sales_dat, death_int_slope_df) %&gt;% 
  group_by(county) %&gt;% 
  ggplot(aes(x = year, y = opioid_poisoning_deaths/population*10000, color = .cluster, text = county)) + 
  geom_point() + 
  geom_path() +
  scale_x_continuous(breaks = c(0, 1, 2), labels = c(&quot;2010&quot;, &quot;2011&quot;, &quot;2012&quot;)) +
  theme(legend.position = &quot;none&quot;) + 
  xlab(&quot;Year&quot;) +
  ylab(&quot;Opioid Related Deaths per 10000&quot;)</code></pre>
<pre class="r"><code>ggplotly(deaths_plot, tooltip = &quot;text&quot;)</code></pre>
<div id="htmlwidget-fc17a57f69b732e7c9b9" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-fc17a57f69b732e7c9b9">{"x":{"data":[{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[3.05467874961816,5.102978098018,3.07144173475029,4.3515559920926,4.987282429804,1.25006250312516,2.42777373148823,4.25454324439312,1.82806444536525,5.40263108133661,4.54787395314679,6.55922984550491,4.17000266880171,1.66761164659974,1.66688891852247,2.743973548095,4.10082563289409,2.74058950080162,4.85967120853081,3.7030865226166,4.63243911816889,3.37654409361401,5.10982080665245,5.49670063895793,4.09098347242677,5.31888777965075,4.09651386669944,4.65414947779094,7.26208111072186,6.70079605457128,4.50885668276973,16.1180096192281,6.46495991724851,2.73549911916928,4.65218105194023,4.38317736527209],"text":["Allegany","Allegany","Allegany","Cayuga","Cayuga","Cayuga","Clinton","Clinton","Clinton","Dutchess","Dutchess","Dutchess","Genesee","Genesee","Genesee","Madison","Madison","Madison","Niagara","Niagara","Niagara","Orange","Orange","Orange","Oswego","Oswego","Oswego","Suffolk","Suffolk","Suffolk","Sullivan","Sullivan","Sullivan","Ulster","Ulster","Ulster"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[0.6189957413093,0.621287805362956,2.49482324177332,2.81823510844569,4.50800734805198,6.75835501638901,0,1.93382452476262,4.83577701265039,1.80189920175865,3.6064627813041,4.33541674193432,4.04776361060514,7.09967950018256,10.1787386507064,1.30356568667495,5.17504592853262,4.27310252882208,1.52809400834339,2.29403398229006,4.60016867285134,2.37220295705881,3.44144489063733,4.50470741925312,2.51142699281732,2.00678292629086,6.01793344165613,1.47318315595117,1.29583195651188,3.20501520779716,1.41606955733666,1.41618988273948,7.08094941369739,0.993917226573371,2.47443904466857,3.9381707197007,0,0,1.90150218672751,0,0,2.37574836073363,0,1.97300923368321,1.97230878466333],"text":["Cattaraugus","Cattaraugus","Cattaraugus","Chemung","Chemung","Chemung","Franklin","Franklin","Franklin","Fulton","Fulton","Fulton","Greene","Greene","Greene","Jefferson","Jefferson","Jefferson","Livingston","Livingston","Livingston","Onondaga","Onondaga","Onondaga","Putnam","Putnam","Putnam","Rockland","Rockland","Rockland","Seneca","Seneca","Seneca","Tompkins","Tompkins","Tompkins","Washington","Washington","Washington","Wyoming","Wyoming","Wyoming","Yates","Yates","Yates"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[2.46684559520051,3.12544208555815,2.29876753220738,2.59935199253144,3.38281949638911,3.93114650986321,2.48999023923826,1.99553001277139,3.25117042135169,1.84825118472901,1.85160497118903,2.97179028075989,2.9385836027035,0.984484523903284,2.9708853238265,0.790626334181939,3.17183411307589,1.59030549768611,2.02216290544366,1.01130640561477,2.02212201484238,2.07382828701783,2.07991014788161,3.13473072663058,2.55101486970285,3.31624831197524,3.04499413838628,0,2.54084406839952,0,0,0,0,1.55443636137537,2.33085744475868,0,3.70137320946071,0,1.84760919370335,2.36080045974903,3.2310917185773,3.22257521356275,1.00110121133247,0,0,2.44529498910151,3.82610861497119,4.14577593985861,2.7714649963971,1.49222550511833,2.34705721698757,0.940751472276054,1.4009526478005,1.85652755086885,1.15823855081193,1.16249331566343,0,0.798671011436969,3.20615581917281,1.60908812975687,1.97801987932715,2.0325414401324,2.1029007502434,2.83680789767319,1.57180310965527,3.76260472583154,0.460269533839016,1.83049606443346,0.9097856544998,0.652451914293917,1.62406210413486,1.61847914751466,0,1.52597204419215,0,0,0,0,1.51938738300717,2.02353369689489,1.0101826410215,0.973198123674017,2.9247177647357,0.979105880509918,0.760953931848966,0.760259704715131,0.60882800608828,1.60164007944135,2.13611312855129,0.534896657965681,1.49030344707187,2.75351099127455,2.68356929449489],"text":["Albany","Albany","Albany","Bronx","Bronx","Bronx","Broome","Broome","Broome","Chautauqua","Chautauqua","Chautauqua","Chenango","Chenango","Chenango","Columbia","Columbia","Columbia","Cortland","Cortland","Cortland","Delaware","Delaware","Delaware","Erie","Erie","Erie","Essex","Essex","Essex","Hamilton","Hamilton","Hamilton","Herkimer","Herkimer","Herkimer","Lewis","Lewis","Lewis","Monroe","Monroe","Monroe","Montgomery","Montgomery","Montgomery","Nassau","Nassau","Nassau","Oneida","Oneida","Oneida","Ontario","Ontario","Ontario","Orleans","Orleans","Orleans","Otsego","Otsego","Otsego","Queens","Queens","Queens","Rensselaer","Rensselaer","Rensselaer","Saratoga","Saratoga","Saratoga","Schenectady","Schenectady","Schenectady","Schoharie","Schoharie","Schoharie","Schuyler","Schuyler","Schuyler","Steuben","Steuben","Steuben","Tioga","Tioga","Tioga","Warren","Warren","Warren","Wayne","Wayne","Wayne","Westchester","Westchester","Westchester"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[3.05467874961816,5.102978098018,3.07144173475029,null,4.3515559920926,4.987282429804,1.25006250312516,null,2.42777373148823,4.25454324439312,1.82806444536525,null,5.40263108133661,4.54787395314679,6.55922984550491,null,4.17000266880171,1.66761164659974,1.66688891852247,null,2.743973548095,4.10082563289409,2.74058950080162,null,4.85967120853081,3.7030865226166,4.63243911816889,null,3.37654409361401,5.10982080665245,5.49670063895793,null,4.09098347242677,5.31888777965075,4.09651386669944,null,4.65414947779094,7.26208111072186,6.70079605457128,null,4.50885668276973,16.1180096192281,6.46495991724851,null,2.73549911916928,4.65218105194023,4.38317736527209],"text":["Allegany","Allegany","Allegany",null,"Cayuga","Cayuga","Cayuga",null,"Clinton","Clinton","Clinton",null,"Dutchess","Dutchess","Dutchess",null,"Genesee","Genesee","Genesee",null,"Madison","Madison","Madison",null,"Niagara","Niagara","Niagara",null,"Orange","Orange","Orange",null,"Oswego","Oswego","Oswego",null,"Suffolk","Suffolk","Suffolk",null,"Sullivan","Sullivan","Sullivan",null,"Ulster","Ulster","Ulster"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[0.6189957413093,0.621287805362956,2.49482324177332,null,2.81823510844569,4.50800734805198,6.75835501638901,null,0,1.93382452476262,4.83577701265039,null,1.80189920175865,3.6064627813041,4.33541674193432,null,4.04776361060514,7.09967950018256,10.1787386507064,null,1.30356568667495,5.17504592853262,4.27310252882208,null,1.52809400834339,2.29403398229006,4.60016867285134,null,2.37220295705881,3.44144489063733,4.50470741925312,null,2.51142699281732,2.00678292629086,6.01793344165613,null,1.47318315595117,1.29583195651188,3.20501520779716,null,1.41606955733666,1.41618988273948,7.08094941369739,null,0.993917226573371,2.47443904466857,3.9381707197007,null,0,0,1.90150218672751,null,0,0,2.37574836073363,null,0,1.97300923368321,1.97230878466333],"text":["Cattaraugus","Cattaraugus","Cattaraugus",null,"Chemung","Chemung","Chemung",null,"Franklin","Franklin","Franklin",null,"Fulton","Fulton","Fulton",null,"Greene","Greene","Greene",null,"Jefferson","Jefferson","Jefferson",null,"Livingston","Livingston","Livingston",null,"Onondaga","Onondaga","Onondaga",null,"Putnam","Putnam","Putnam",null,"Rockland","Rockland","Rockland",null,"Seneca","Seneca","Seneca",null,"Tompkins","Tompkins","Tompkins",null,"Washington","Washington","Washington",null,"Wyoming","Wyoming","Wyoming",null,"Yates","Yates","Yates"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[2.46684559520051,3.12544208555815,2.29876753220738,null,2.59935199253144,3.38281949638911,3.93114650986321,null,2.48999023923826,1.99553001277139,3.25117042135169,null,1.84825118472901,1.85160497118903,2.97179028075989,null,2.9385836027035,0.984484523903284,2.9708853238265,null,0.790626334181939,3.17183411307589,1.59030549768611,null,2.02216290544366,1.01130640561477,2.02212201484238,null,2.07382828701783,2.07991014788161,3.13473072663058,null,2.55101486970285,3.31624831197524,3.04499413838628,null,0,2.54084406839952,0,null,0,0,0,null,1.55443636137537,2.33085744475868,0,null,3.70137320946071,0,1.84760919370335,null,2.36080045974903,3.2310917185773,3.22257521356275,null,1.00110121133247,0,0,null,2.44529498910151,3.82610861497119,4.14577593985861,null,2.7714649963971,1.49222550511833,2.34705721698757,null,0.940751472276054,1.4009526478005,1.85652755086885,null,1.15823855081193,1.16249331566343,0,null,0.798671011436969,3.20615581917281,1.60908812975687,null,1.97801987932715,2.0325414401324,2.1029007502434,null,2.83680789767319,1.57180310965527,3.76260472583154,null,0.460269533839016,1.83049606443346,0.9097856544998,null,0.652451914293917,1.62406210413486,1.61847914751466,null,0,1.52597204419215,0,null,0,0,0,null,1.51938738300717,2.02353369689489,1.0101826410215,null,0.973198123674017,2.9247177647357,0.979105880509918,null,0.760953931848966,0.760259704715131,0.60882800608828,null,1.60164007944135,2.13611312855129,0.534896657965681,null,1.49030344707187,2.75351099127455,2.68356929449489],"text":["Albany","Albany","Albany",null,"Bronx","Bronx","Bronx",null,"Broome","Broome","Broome",null,"Chautauqua","Chautauqua","Chautauqua",null,"Chenango","Chenango","Chenango",null,"Columbia","Columbia","Columbia",null,"Cortland","Cortland","Cortland",null,"Delaware","Delaware","Delaware",null,"Erie","Erie","Erie",null,"Essex","Essex","Essex",null,"Hamilton","Hamilton","Hamilton",null,"Herkimer","Herkimer","Herkimer",null,"Lewis","Lewis","Lewis",null,"Monroe","Monroe","Monroe",null,"Montgomery","Montgomery","Montgomery",null,"Nassau","Nassau","Nassau",null,"Oneida","Oneida","Oneida",null,"Ontario","Ontario","Ontario",null,"Orleans","Orleans","Orleans",null,"Otsego","Otsego","Otsego",null,"Queens","Queens","Queens",null,"Rensselaer","Rensselaer","Rensselaer",null,"Saratoga","Saratoga","Saratoga",null,"Schenectady","Schenectady","Schenectady",null,"Schoharie","Schoharie","Schoharie",null,"Schuyler","Schuyler","Schuyler",null,"Steuben","Steuben","Steuben",null,"Tioga","Tioga","Tioga",null,"Warren","Warren","Warren",null,"Wayne","Wayne","Wayne",null,"Westchester","Westchester","Westchester"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.7412480974125,"r":7.30593607305936,"b":39.6955859969559,"l":37.2602739726027},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.1,2.1],"tickmode":"array","ticktext":["2010","2011","2012"],"tickvals":[0,1,2],"categoryorder":"array","categoryarray":["2010","2011","2012"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.805900480961407,16.9239101001895],"tickmode":"array","ticktext":["0","5","10","15"],"tickvals":[0,5,10,15],"categoryorder":"array","categoryarray":["0","5","10","15"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Opioid Related Deaths per 10000","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"44705b0b2d6b":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"447065277c16":{"x":{},"y":{},"colour":{},"text":{}}},"cur_data":"44705b0b2d6b","visdat":{"44705b0b2d6b":["function (y) ","x"],"447065277c16":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="clustering-with-er-visits" class="section level2">
<h2>Clustering with ER Visits</h2>
<pre class="r"><code>er_sales_dat &lt;- death_sales_df %&gt;% 
  select(county, year, er_opioid, population) %&gt;% 
  mutate(
    year = recode(year,
                  &quot;2010&quot; = 0,
                  &quot;2011&quot; = 1,
                  &quot;2012&quot; = 2)
  )</code></pre>
<pre class="r"><code>er_int_slope_df &lt;- er_sales_dat %&gt;% 
  nest(data = year:population) %&gt;%
  mutate(
    models = map(data, ~lm(er_opioid/population*10000 ~ year, data = .x)),
    result = map(models, broom::tidy)
  ) %&gt;% 
  select(county, result) %&gt;% 
  unnest(result) %&gt;% 
  select(county, term, estimate) %&gt;% 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) %&gt;% 
  rename(int = &quot;(Intercept)&quot;, slope = year)</code></pre>
<pre class="r"><code>er_km_fit = 
  kmeans(
    er_int_slope_df[,c(2,3)] %&gt;% scale, 
    centers = 3)

er_int_slope_df =
  broom::augment(er_km_fit, er_int_slope_df)</code></pre>
<pre class="r"><code>er_plot &lt;- left_join(er_sales_dat, er_int_slope_df) %&gt;% 
  group_by(county) %&gt;% 
  ggplot(aes(x = year, y = er_opioid/population*10000, color = .cluster, text = county)) + 
  geom_point() +
  geom_path() +
  scale_x_continuous(breaks = c(0, 1, 2), labels = c(&quot;2010&quot;, &quot;2011&quot;, &quot;2012&quot;)) +
  theme(legend.position = &quot;none&quot;) +
  xlab(&quot;Year&quot;) +
  ylab(&quot;Opioid Related ER Visits per 10000&quot;)</code></pre>
<pre class="r"><code>ggplotly(er_plot, tooltip = &quot;text&quot;)</code></pre>
<div id="htmlwidget-cb963e7fc79bc97ee9b1" style="width:90%;height:576px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cb963e7fc79bc97ee9b1">{"x":{"data":[{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[1.45666423889294,0.60779189205616,0.487483852097399,1.86644545831605,2.49589217745793,1.67185638753631,2.46417181030871,3.16402707798294,2.75136970361332,1.7759285569312,1.77859084787967,1.52636800732657,2.03748981255094,2.05338809034908,0,2.48709817820058,1.55390496317245,0.930593253198914,2.60286314946441,1.80054016204861,1.5992003998001,2.31647710162385,1.8599893050615,1.62809629026631,2.07654462973612,1.60307790958641,1.76999694273255,2.2064061426347,1.7604194828139,1.88130236291577,2.43984263015036,1.52597204419215,1.2263543550909,2.69309490466444,2.70416441319632,2.7067994802945,2.83213911467331,2.26590381238316,2.54914178893106,1.82628943643752,2.28077911414539,1.06544901065449,2.37623762376238,1.18380554020993,1.57784702773066],"text":["Clinton","Clinton","Clinton","Delaware","Delaware","Delaware","Erie","Erie","Erie","Essex","Essex","Essex","Hamilton","Hamilton","Hamilton","Herkimer","Herkimer","Herkimer","Montgomery","Montgomery","Montgomery","Orleans","Orleans","Orleans","Otsego","Otsego","Otsego","Rensselaer","Rensselaer","Rensselaer","Schoharie","Schoharie","Schoharie","Schuyler","Schuyler","Schuyler","Seneca","Seneca","Seneca","Warren","Warren","Warren","Yates","Yates","Yates"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(68,1,84,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)"}},"hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[2.00636775076308,2.23715854545215,2.29876753220738,2.34059082488397,3.39240102171137,4.40158457044536,1.49196205443175,1.7455488504314,2.12510625531277,1.77432113733985,2.14786176657927,2.6003164956649,1.35275285205393,1.57780257181819,1.3516710032778,1.95905573513566,1.77207214302591,2.9708853238265,1.10687686785471,2.53746729046071,1.74933604745472,1.8199466148993,2.02261281122955,2.42654641781085,1.99222021124288,2.69503641667958,3.46461884147182,1.50120096076861,1.50085048193977,1.83357781037472,1.06966580584038,2.29403398229006,1.68672851337882,1.9207814836665,1.23024768986823,1.78138317552105,1.36251912248372,1.92519214898564,2.02753690519989,1.89758590047393,2.22185191356996,2.36254395026613,1.74815484388124,1.40695547625443,1.96299330875324,1.94089332850267,2.88221009590877,3.45360902142739,1.88150294455211,2.42831792285421,2.22783306104263,1.70177822318146,2.0708221163802,3.29802038337476,1.56491641505265,1.46439685154677,1.3646784817497,2.02260093431114,2.01383700912723,2.13639247471936,2.1112301254327,2.32655561510163,2.74062558631966,1.54589371980676,2.44993746212268,2.97388156193432,1.69600945388496,1.6966777954135,2.62990641916325,1.10956124778088,1.74122265488967,0.792292577803131,1.8882620907782,1.42102645477583,2.13817352466027],"text":["Albany","Albany","Albany","Broome","Broome","Broome","Cayuga","Cayuga","Cayuga","Chautauqua","Chautauqua","Chautauqua","Chemung","Chemung","Chemung","Chenango","Chenango","Chenango","Columbia","Columbia","Columbia","Cortland","Cortland","Cortland","Dutchess","Dutchess","Dutchess","Genesee","Genesee","Genesee","Livingston","Livingston","Livingston","Madison","Madison","Madison","Monroe","Monroe","Monroe","Niagara","Niagara","Niagara","Oneida","Oneida","Oneida","Onondaga","Onondaga","Onondaga","Ontario","Ontario","Ontario","Orange","Orange","Orange","Saratoga","Saratoga","Saratoga","Schenectady","Schenectady","Schenectady","Suffolk","Suffolk","Suffolk","Sullivan","Sullivan","Sullivan","Ulster","Ulster","Ulster","Washington","Washington","Washington","Wyoming","Wyoming","Wyoming"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(33,144,140,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)"}},"hoveron":"points","name":"2","legendgroup":"2","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2,0,1,2],"y":[0.814580999898177,1.22471474352432,1.4333394762168,1.10563986161196,1.22217994708252,1.08196692932015,0.86659403783302,1.73960585501628,0.997929296709328,0.773739288546724,1.16029471485757,0.967155402530079,1.08113952105519,0.540969417195615,1.08385418548358,1.01194090265129,1.62278388575601,2.03574773014128,0.782139412004971,1.3800122476087,1.96562716325816,0.370137320946071,0.369863520360987,1.10856551622201,0.797542365676184,0.870252155562074,0.941203186346279,1.30911471117657,1.71840989804101,3.11335053869157,1.00457079712693,1.50508719471815,2.60777115805099,0.60022672200272,0.532977533190273,0.617447454326785,0.720222876242794,0.64791597825594,1.02560486649509,1.01292492200478,1.21412021813693,2.22240181024729,1.36247737314362,0.974905921578568,1.37074823271389,0.496958613286686,0.791820494293944,1.47681401988776,0.854208042368719,1.28166787713077,1.1767726475245,0.649346501938459,0.921367139388022,1.02080871202355],"text":["Allegany","Allegany","Allegany","Bronx","Bronx","Bronx","Cattaraugus","Cattaraugus","Cattaraugus","Franklin","Franklin","Franklin","Fulton","Fulton","Fulton","Greene","Greene","Greene","Jefferson","Jefferson","Jefferson","Lewis","Lewis","Lewis","Nassau","Nassau","Nassau","Oswego","Oswego","Oswego","Putnam","Putnam","Putnam","Queens","Queens","Queens","Rockland","Rockland","Rockland","Steuben","Steuben","Steuben","Tioga","Tioga","Tioga","Tompkins","Tompkins","Tompkins","Wayne","Wayne","Wayne","Westchester","Westchester","Westchester"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(253,231,37,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)"}},"hoveron":"points","name":"3","legendgroup":"3","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[1.45666423889294,0.60779189205616,0.487483852097399,null,1.86644545831605,2.49589217745793,1.67185638753631,null,2.46417181030871,3.16402707798294,2.75136970361332,null,1.7759285569312,1.77859084787967,1.52636800732657,null,2.03748981255094,2.05338809034908,0,null,2.48709817820058,1.55390496317245,0.930593253198914,null,2.60286314946441,1.80054016204861,1.5992003998001,null,2.31647710162385,1.8599893050615,1.62809629026631,null,2.07654462973612,1.60307790958641,1.76999694273255,null,2.2064061426347,1.7604194828139,1.88130236291577,null,2.43984263015036,1.52597204419215,1.2263543550909,null,2.69309490466444,2.70416441319632,2.7067994802945,null,2.83213911467331,2.26590381238316,2.54914178893106,null,1.82628943643752,2.28077911414539,1.06544901065449,null,2.37623762376238,1.18380554020993,1.57784702773066],"text":["Clinton","Clinton","Clinton",null,"Delaware","Delaware","Delaware",null,"Erie","Erie","Erie",null,"Essex","Essex","Essex",null,"Hamilton","Hamilton","Hamilton",null,"Herkimer","Herkimer","Herkimer",null,"Montgomery","Montgomery","Montgomery",null,"Orleans","Orleans","Orleans",null,"Otsego","Otsego","Otsego",null,"Rensselaer","Rensselaer","Rensselaer",null,"Schoharie","Schoharie","Schoharie",null,"Schuyler","Schuyler","Schuyler",null,"Seneca","Seneca","Seneca",null,"Warren","Warren","Warren",null,"Yates","Yates","Yates"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(68,1,84,1)","dash":"solid"},"hoveron":"points","name":"1","legendgroup":"1","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[2.00636775076308,2.23715854545215,2.29876753220738,null,2.34059082488397,3.39240102171137,4.40158457044536,null,1.49196205443175,1.7455488504314,2.12510625531277,null,1.77432113733985,2.14786176657927,2.6003164956649,null,1.35275285205393,1.57780257181819,1.3516710032778,null,1.95905573513566,1.77207214302591,2.9708853238265,null,1.10687686785471,2.53746729046071,1.74933604745472,null,1.8199466148993,2.02261281122955,2.42654641781085,null,1.99222021124288,2.69503641667958,3.46461884147182,null,1.50120096076861,1.50085048193977,1.83357781037472,null,1.06966580584038,2.29403398229006,1.68672851337882,null,1.9207814836665,1.23024768986823,1.78138317552105,null,1.36251912248372,1.92519214898564,2.02753690519989,null,1.89758590047393,2.22185191356996,2.36254395026613,null,1.74815484388124,1.40695547625443,1.96299330875324,null,1.94089332850267,2.88221009590877,3.45360902142739,null,1.88150294455211,2.42831792285421,2.22783306104263,null,1.70177822318146,2.0708221163802,3.29802038337476,null,1.56491641505265,1.46439685154677,1.3646784817497,null,2.02260093431114,2.01383700912723,2.13639247471936,null,2.1112301254327,2.32655561510163,2.74062558631966,null,1.54589371980676,2.44993746212268,2.97388156193432,null,1.69600945388496,1.6966777954135,2.62990641916325,null,1.10956124778088,1.74122265488967,0.792292577803131,null,1.8882620907782,1.42102645477583,2.13817352466027],"text":["Albany","Albany","Albany",null,"Broome","Broome","Broome",null,"Cayuga","Cayuga","Cayuga",null,"Chautauqua","Chautauqua","Chautauqua",null,"Chemung","Chemung","Chemung",null,"Chenango","Chenango","Chenango",null,"Columbia","Columbia","Columbia",null,"Cortland","Cortland","Cortland",null,"Dutchess","Dutchess","Dutchess",null,"Genesee","Genesee","Genesee",null,"Livingston","Livingston","Livingston",null,"Madison","Madison","Madison",null,"Monroe","Monroe","Monroe",null,"Niagara","Niagara","Niagara",null,"Oneida","Oneida","Oneida",null,"Onondaga","Onondaga","Onondaga",null,"Ontario","Ontario","Ontario",null,"Orange","Orange","Orange",null,"Saratoga","Saratoga","Saratoga",null,"Schenectady","Schenectady","Schenectady",null,"Suffolk","Suffolk","Suffolk",null,"Sullivan","Sullivan","Sullivan",null,"Ulster","Ulster","Ulster",null,"Washington","Washington","Washington",null,"Wyoming","Wyoming","Wyoming"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(33,144,140,1)","dash":"solid"},"hoveron":"points","name":"2","legendgroup":"2","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2,null,0,1,2],"y":[0.814580999898177,1.22471474352432,1.4333394762168,null,1.10563986161196,1.22217994708252,1.08196692932015,null,0.86659403783302,1.73960585501628,0.997929296709328,null,0.773739288546724,1.16029471485757,0.967155402530079,null,1.08113952105519,0.540969417195615,1.08385418548358,null,1.01194090265129,1.62278388575601,2.03574773014128,null,0.782139412004971,1.3800122476087,1.96562716325816,null,0.370137320946071,0.369863520360987,1.10856551622201,null,0.797542365676184,0.870252155562074,0.941203186346279,null,1.30911471117657,1.71840989804101,3.11335053869157,null,1.00457079712693,1.50508719471815,2.60777115805099,null,0.60022672200272,0.532977533190273,0.617447454326785,null,0.720222876242794,0.64791597825594,1.02560486649509,null,1.01292492200478,1.21412021813693,2.22240181024729,null,1.36247737314362,0.974905921578568,1.37074823271389,null,0.496958613286686,0.791820494293944,1.47681401988776,null,0.854208042368719,1.28166787713077,1.1767726475245,null,0.649346501938459,0.921367139388022,1.02080871202355],"text":["Allegany","Allegany","Allegany",null,"Bronx","Bronx","Bronx",null,"Cattaraugus","Cattaraugus","Cattaraugus",null,"Franklin","Franklin","Franklin",null,"Fulton","Fulton","Fulton",null,"Greene","Greene","Greene",null,"Jefferson","Jefferson","Jefferson",null,"Lewis","Lewis","Lewis",null,"Nassau","Nassau","Nassau",null,"Oswego","Oswego","Oswego",null,"Putnam","Putnam","Putnam",null,"Queens","Queens","Queens",null,"Rockland","Rockland","Rockland",null,"Steuben","Steuben","Steuben",null,"Tioga","Tioga","Tioga",null,"Tompkins","Tompkins","Tompkins",null,"Wayne","Wayne","Wayne",null,"Westchester","Westchester","Westchester"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(253,231,37,1)","dash":"solid"},"hoveron":"points","name":"3","legendgroup":"3","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":25.7412480974125,"r":7.30593607305936,"b":39.6955859969559,"l":31.4155251141553},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.1,2.1],"tickmode":"array","ticktext":["2010","2011","2012"],"tickvals":[0,1,2],"categoryorder":"array","categoryarray":["2010","2011","2012"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.220079228522268,4.62166379896763],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Opioid Related ER Visits per 10000","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"447051561d35":{"x":{},"y":{},"colour":{},"text":{},"type":"scatter"},"44701b2943d4":{"x":{},"y":{},"colour":{},"text":{}}},"cur_data":"447051561d35","visdat":{"447051561d35":["function (y) ","x"],"44701b2943d4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="scatter-plots" class="section level2">
<h2>Scatter Plots</h2>
<p>This scatter plot shows the number of opioid-related deaths per 10000 people versus the number of</p>
<p>pills prescribed adjusted by population.</p>
<pre class="r"><code>join_df %&gt;% 
  ggplot(aes(x = ppp, y = opioid_poisoning_deaths/population*10000)) +
  geom_point() +
  geom_smooth(method = &quot;lm&quot;, se = FALSE) +
  xlab(&quot;Pills Bought per Person&quot;) +
  ylab(&quot;Opioid Related Deaths per 10000&quot;)</code></pre>
<p><img src="stat_learning_files/figure-html/unnamed-chunk-19-1.png" width="90%" /></p>
<pre class="r"><code>fit &lt;- lm(opioid_poisoning_deaths/population*10000 ~ ppp, data = join_df)
summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = opioid_poisoning_deaths/population * 10000 ~ ppp, 
##     data = join_df)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.291 -1.306 -0.328  1.035 12.876 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   1.1261     0.5778   1.949  0.05291 . 
## ppp          15.9136     6.0201   2.643  0.00897 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.056 on 172 degrees of freedom
## Multiple R-squared:  0.03904,    Adjusted R-squared:  0.03345 
## F-statistic: 6.988 on 1 and 172 DF,  p-value: 0.008966</code></pre>
</div>
<div id="model-building" class="section level2">
<h2>Model Building</h2>
<p>For the purposes of this model I created a region variable that measures whether a county is in</p>
<p>New York City or the rest of New York State. I tested two nested stepwise models to determine</p>
<p>which model would be best at predicting the raw number of opioid poisoning deaths. Then, variables</p>
<p>in the larger model were removed starting with the highest VIF until no variables had a VIF score</p>
<p>greater than 10.</p>
<pre class="r"><code>join_dat &lt;- join_df %&gt;%
  ungroup() %&gt;% 
  mutate(year = factor(year),
         region = ifelse(county %in% c(&quot;New York&quot;, &quot;Kings&quot;, &quot;Bronx&quot;, &quot;Queens&quot;, &quot;Richmond&quot;), &quot;NYC&quot;, &quot;ROS&quot;)) %&gt;% 
  select(-county)
fit1 &lt;- lm(opioid_poisoning_deaths ~ . -pills_bought 
           -inpatient_total_opioid -er_inpatient_total_opioid -overall_opioid, data = join_dat)
fit2 &lt;- lm(opioid_poisoning_deaths ~ region + pills_bought + rural_urban, data = join_dat)

model1 &lt;- step(fit1)</code></pre>
<pre><code>## Start:  AIC=1376.93
## opioid_poisoning_deaths ~ (year + rural_urban + er_opioid + inpatient_total_opioid + 
##     er_inpatient_total_opioid + outpatient_opioid + overall_opioid + 
##     pills_bought + population + ppp + region) - pills_bought - 
##     inpatient_total_opioid - er_inpatient_total_opioid - overall_opioid
## 
##                     Df Sum of Sq    RSS    AIC
## - year               2      2169 431085 1373.8
## - ppp                1      2683 431599 1376.0
## &lt;none&gt;                           428916 1376.9
## - rural_urban        1      6692 435608 1377.6
## - region             1     17597 446512 1381.9
## - outpatient_opioid  1     69363 498279 1401.0
## - population         1    162203 591119 1430.7
## - er_opioid          1    240502 669418 1452.4
## 
## Step:  AIC=1373.81
## opioid_poisoning_deaths ~ rural_urban + er_opioid + outpatient_opioid + 
##     population + ppp + region
## 
##                     Df Sum of Sq    RSS    AIC
## - ppp                1      2982 434067 1373.0
## &lt;none&gt;                           431085 1373.8
## - rural_urban        1      6814 437898 1374.5
## - region             1     17069 448154 1378.6
## - outpatient_opioid  1     75705 506790 1400.0
## - population         1    160125 591210 1426.8
## - er_opioid          1    249365 680450 1451.2
## 
## Step:  AIC=1373.01
## opioid_poisoning_deaths ~ rural_urban + er_opioid + outpatient_opioid + 
##     population + region
## 
##                     Df Sum of Sq    RSS    AIC
## &lt;none&gt;                           434067 1373.0
## - rural_urban        1      5770 439837 1373.3
## - region             1     15983 450050 1377.3
## - outpatient_opioid  1     75991 510057 1399.1
## - population         1    177648 611715 1430.7
## - er_opioid          1    248842 682909 1449.9</code></pre>
<pre class="r"><code>model2 &lt;- step(fit2)</code></pre>
<pre><code>## Start:  AIC=1471.03
## opioid_poisoning_deaths ~ region + pills_bought + rural_urban
## 
##                Df Sum of Sq     RSS    AIC
## - rural_urban   1      4703  784877 1470.1
## &lt;none&gt;                       780174 1471.0
## - region        1     64678  844852 1482.9
## - pills_bought  1   2449565 3229740 1716.2
## 
## Step:  AIC=1470.08
## opioid_poisoning_deaths ~ region + pills_bought
## 
##                Df Sum of Sq     RSS    AIC
## &lt;none&gt;                       784877 1470.1
## - region        1     64438  849315 1481.8
## - pills_bought  1   2755588 3540466 1730.2</code></pre>
<pre class="r"><code>summary(model1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = opioid_poisoning_deaths ~ rural_urban + er_opioid + 
##     outpatient_opioid + population + region, data = join_dat)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -203.436  -12.149    2.666   16.297  259.917 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -9.690e+01  3.580e+01  -2.707  0.00749 ** 
## rural_urbanUrban  -1.298e+01  8.685e+00  -1.494  0.13694    
## er_opioid          1.167e+00  1.189e-01   9.814  &lt; 2e-16 ***
## outpatient_opioid  1.745e+01  3.218e+00   5.423 2.01e-07 ***
## population         1.900e-04  2.292e-05   8.292 3.43e-14 ***
## regionROS          8.650e+01  3.478e+01   2.487  0.01385 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 50.83 on 168 degrees of freedom
## Multiple R-squared:  0.9015, Adjusted R-squared:  0.8985 
## F-statistic: 307.4 on 5 and 168 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(model2)</code></pre>
<pre><code>## 
## Call:
## lm(formula = opioid_poisoning_deaths ~ region + pills_bought, 
##     data = join_dat)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -269.53  -14.87    3.60   14.03  438.69 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   9.333e+01  3.132e+01   2.980 0.003301 ** 
## regionROS    -1.134e+02  3.027e+01  -3.747 0.000245 ***
## pills_bought  4.918e-03  2.007e-04  24.502  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 67.75 on 171 degrees of freedom
## Multiple R-squared:  0.8218, Adjusted R-squared:  0.8198 
## F-statistic: 394.4 on 2 and 171 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>anova(model1, model2)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Model 1: opioid_poisoning_deaths ~ rural_urban + er_opioid + outpatient_opioid + 
##     population + region
## Model 2: opioid_poisoning_deaths ~ region + pills_bought
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    168 434067                                  
## 2    171 784877 -3   -350811 45.259 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
